{
 "absolute_value": 0,
 "align_labels_right": 0,
 "creation": "2023-03-17 17:37:15.523417",
 "css": "",
 "custom_format": 1,
 "default_print_language": "en",
 "disabled": 0,
 "doc_type": "Send Customer Statements",
 "docstatus": 0,
 "doctype": "Print Format",
 "font_size": 14,
 "html": "<head>\n\t<style>\n\t\t\t@media screen {\n\t\t     .print-format-gutter {\n\t\t         background-color: #d1d8dd;\n\t\t         padding: 30px 0px;\n\t\t    }\n\t\t     .print-format {\n\t\t         background-color: white;\n\t\t         box-shadow: 0px 0px 9px rgba(0,0,0,0.5);\n\t\t         max-width: 8.3in;\n\t\t         min-height: 11.69in;\n\t\t         padding: 0.25in;\n\t\t         margin: auto;\n\t\t    }\n\t\t     .print-format.landscape {\n\t\t         max-width: 11.69in;\n\t\t         padding: 0.2in;\n\t\t    }\n\t\t     .page-break {\n\t\t         padding: 30px 0px;\n\t\t         border-bottom: 1px dashed #888;\n\t\t    }\n\t\t     .page-break:first-child {\n\t\t         padding-top: 0px;\n\t\t    }\n\t\t     .page-break:last-child {\n\t\t         border-bottom: 0px;\n\t\t    }\n\t\t     body:last-child .print-format td img {\n\t\t         width: 100% !important;\n\t\t    }\n\t\t     @media(max-width: 767px) {\n\t\t         .print-format {\n\t\t             padding: 0.2in;\n\t\t        }\n\t\t    }\n\t\t}\n\t\t @media print {\n\t\t     .print-format p {\n\t\t         margin-left: 1px;\n\t\t         margin-right: 1px;\n\t\t    }\n\t\t}\n\t\t .disabled-check {\n\t\t     color: #eee;\n\t\t}\n\t\t .data-field {\n\t\t     margin-top: 5px;\n\t\t     margin-bottom: 5px;\n\t\t}\n\t\t .data-field .value {\n\t\t     word-wrap: break-word;\n\t\t}\n\t\t .important .value {\n\t\t     font-size: 120%;\n\t\t     font-weight: bold;\n\t\t}\n\t\t .important label {\n\t\t     line-height: 1.8;\n\t\t     margin: 0px;\n\t\t}\n\t\t .table {\n\t\t     margin: 20px 0px;\n\t\t}\n\t\t .square-image {\n\t\t     width: 100%;\n\t\t     height: 0;\n\t\t     padding: 50% 0;\n\t\t     background-size: contain;\n\t\t    /*background-size: cover;\n\t\t    */\n\t\t     background-repeat: no-repeat !important;\n\t\t     background-position: center center;\n\t\t     border-radius: 4px;\n\t\t}\n\t\t .print-item-image {\n\t\t     object-fit: contain;\n\t\t}\n\t\t .pdf-variables, .pdf-variable, .visible-pdf {\n\t\t     display: none !important;\n\t\t}\n\t\t .print-format {\n\t\t     font-size: 9pt;\n\t\t     font-family: \"Helvetica Neue\", Helvetica, Arial, \"Open Sans\", sans-serif;\n\t\t     -webkit-print-color-adjust:exact;\n\t\t}\n\t\t .print-format table {\n\t\t     font-size: 9pt;\n\t\t     font-family: \"Helvetica Neue\", Helvetica, Arial, \"Open Sans\", sans-serif;\n\t\t     -webkit-print-color-adjust:exact;\n\t\t}\n\t\t .page-break {\n\t\t     page-break-after: always;\n\t\t}\n\t\t .print-heading {\n\t\t     border-bottom: 1px solid #aaa;\n\t\t     margin-bottom: 10px;\n\t\t}\n\t\t .print-heading h2 {\n\t\t     margin: 0px;\n\t\t}\n\t\t .print-heading h4 {\n\t\t     margin-top: 5px;\n\t\t}\n\t\t table.no-border, table.no-border td {\n\t\t     border: 0px;\n\t\t}\n\t\t .print-format label {\n\t\t     display: block;\n\t\t}\n\t\t .print-format img {\n\t\t     max-width: 100%;\n\t\t}\n\t\t .print-format table td > .primary:first-child {\n\t\t     font-weight: bold;\n\t\t}\n\t\t .print-format td, .print-format th {\n\t\t     vertical-align: top !important;\n\t\t     padding: 6px !important;\n\t\t}\n\t\t .print-format p {\n\t\t     margin: 3px 0px 3px;\n\t\t}\n\t\t table td div {\n\t\t     page-break-inside: avoid !important;\n\t\t}\n\t\t @media (-webkit-min-device-pixel-ratio:0) {\n\t\t     thead, tfoot {\n\t\t         display: table-header-group;\n\t\t    }\n\t\t}\n\t\t [document-status] {\n\t\t     margin-bottom: 5mm;\n\t\t}\n\t\t .signature-img {\n\t\t     background: #fff;\n\t\t     border-radius: 3px;\n\t\t     margin-top: 5px;\n\t\t     max-height: 150px;\n\t\t}\n\t\t .print-preview [data-fieldtype=\"Table\"] {\n\t\t     overflow: auto;\n\t\t}\n\t\t .print-heading {\n\t\t     text-align: right;\n\t\t     text-transform: uppercase;\n\t\t     color: #666;\n\t\t     padding-bottom: 20px;\n\t\t     margin-bottom: 20px;\n\t\t     border-bottom: 1px solid #d1d8dd;\n\t\t}\n\t\t .print-heading h2 {\n\t\t     font-size: 24px;\n\t\t}\n\t\t .print-format th {\n\t\t     background-color: #eee !important;\n\t\t     border-bottom: 0px !important;\n\t\t}\n\t\t.ontop {\n            border-top: 1px solid !important;\n\t\t}\n\t\t.onbottom {\n            border-top: 1px solid !important;\n\t\t}\n\t\t.onleft {\n            border-top: 1px solid !important;\n\t\t}\n\t\t.onright {\n            border-top: 1px solid !important;\n\t\t}\n\t\t.notop {\n            border-bottom: 0 !important;\n        }\n\t\t.nobottom {\n            border-bottom: 0 !important;\n        }\n        \n        body\n        {\n            counter-reset: page;\n        }\n        #pageFooter\n        {\n            /*page-break-before: always;*/\n            counter-increment: page;\n        }\n        #pageFooter:after\n        {\n            display: block;\n            text-align: left;\n            content: \"Page \" counter(page);\n            font-size:12px;\n            font-weight: bold;\n\t</style>\n</head>\n<body>\n{% set customer = frappe.get_doc(\"Customer\", filters['party'][0]) %}\n{% set customer_email = frappe.db.get_value(\"Address\", customer.customer_primary_address,'email_id') %}\n{% set customer_statement_letter_head = frappe.db.get_single_value(\"Send Customer Statements\",'letter_head') %}\n{% set customer_statement_doc = frappe.get_doc(\"Send Customer Statements\") %}\n{% set letter_head_path = frappe.db.get_value(\"Letter Head\", customer_statement_letter_head ,'image') %}\n{% set company_add_title = frappe.db.get_all(\"Dynamic Link\",{'link_doctype':\"Company\",'link_name':customer_statement_doc.company},pluck='parent',order_by=\"creation\")[0] %}\n{% set office_address = frappe.get_doc(\"Address\",company_add_title) %}\n<div class=\"print-format-gutter\">\n\t\t<div class=\"print-format\">\n\n\t\t\t<!--<div id=\"header-html\">-->\n\t\t\t    \n\t\t\t<!--</div>-->\n\t\t\t<table width=100%>\n\t\t\t        <tr>\n\t\t\t\t\t<!--<div class=\"letter-head\">{{ letter_head }}</div>-->\n\t\t\t\t\t    {% if customer_statement_letter_head %}\n        \t\t\t\t\t<td width=50% align='left'>\n        \t\t\t\t\t    <img class=\"img-responsive\" src='{{ letter_head_path }}' style='height: auto; width:auto'>\n                            </td>\n                        {% else %}\n                            <td width=50% align='left'>\n                            </td>\n                        {% endif %}\n                        <td width=50% align='right'>\n    \t\t\t\t\t    <p style='font-size:14px;'><strong>{{office_address.address_title}}</strong></p>\n    \t\t\t\t\t    <p style='font-size:14px;'>{{office_address.address_line1}}</p>\n    \t\t\t\t\t    <p style='font-size:14px;'>{{office_address.address_line2}}</p>\n    \t\t\t\t\t    <p style='font-size:14px;'>{{office_address.city}} {{office_address.pincode}} </p>\n    \t\t\t\t\t    <p style='font-size:14px;'>{{office_address.country}}</p>\n                        </td>\n                    </tr>\n                </table>\n\t\t\t<br>\n\t\t\t<p align=\"left\" style='font-size:14px;'>To,</p> \n\t\t\t<p align=\"left\" style='font-size:14px;'><strong>{{customer.name}}</strong></p>\n\t\t\t<p align=\"left\" style='font-size:14px;'>{{customer.primary_address}}</p>\n\t\t\t\n\t\t\t<h1 align='right'>Statement of Accounts</h1>\n\t\t\t<div>\n\t\t\t    <table align='right' style='width:34%; margin-bottom: 18px;'>\n\t\t\t        {% if customer_statement_doc.from_date and customer_statement_doc.to_date %}\n\t\t\t        <tr>\n\t\t\t            <td colspan=3>\n\t\t\t                <p align='right' class='ontop' style='font-size:14px;'>{{customer_statement_doc.get_formatted('from_date') }} To {{customer_statement_doc.get_formatted('to_date') }} </p>\n\t\t\t                <p align='right' class='onbottom'></p>\n\t\t\t            </td>\n\t\t\t        </tr>\n\t\t\t        {% endif %}\n    \t\t\t    <tr>\n    \t\t\t        <th class = 'notop' colspan=2 style='width:34%' align='left'>Account Summary</th>\n    \t\t\t    </tr>\n    \t\t\t    <tr>\n    \t\t\t        <td style='border: 0px solid black; width:17%'>\n    \t\t\t            <p>Opening Balance</p>\n    \t\t\t        </td>\n    \t\t\t        <td  style='border: 0px solid black; width:17%' align='right'>\n    \t\t\t            <p>{{ frappe.utils.fmt_money(data[0].balance, currency=currency) }}</p>\n    \t\t\t        </td>\n    \t\t\t    </tr>\n    \t\t\t    <tr>\n    \t\t\t        <td style='border: 0px solid black; width:17%'>\n    \t\t\t            <p>Invoiced Amount</p>\n    \t\t\t        </td>\n    \t\t\t        <td  style='border: 0px solid black; width:17%' align='right'>\n    \t\t\t            <p>{{ frappe.utils.fmt_money(data[-2].debit, currency=currency) }}</p>\n    \t\t\t        </td>\n    \t\t\t    </tr>\n    \t\t\t    <tr>\n    \t\t\t        <td style='border: 0px solid black; width:17%'>\n    \t\t\t            <p>Amount Received</p>\n    \t\t\t        </td>\n    \t\t\t        <td  style='border: 0px solid black; width:17%' align='right'>\n    \t\t\t            <p>{{ frappe.utils.fmt_money(data[-2].credit, currency=currency) }}</p>\n    \t\t\t        </td>\n    \t\t\t    </tr>\n    \t\t\t    <tr>\n    \t\t\t        <td class = 'ontop' style='border: 0px solid black; width:17%'>\n    \t\t\t            <p>Balance Due</p>\n    \t\t\t        </td>\n    \t\t\t        <td class = 'ontop'  style='border: 0px solid black; width:17%' align='right'>\n    \t\t\t            <p>{{ frappe.utils.fmt_money(data[-1].balance, currency=currency) }}</p>\n    \t\t\t        </td>\n    \t\t\t    </tr>\n    \t\t\t</table>\n\t\t\t</div>\n\t\t    <br>\n\t\t<table width=100% style='border: 0px solid black;'>\n\t\t\t\t<thead>\n\t\t\t\t\t<tr>\n\t\t\t\t\t    <th class=\"text-center\" style=\"width: 3%\">{{ _(\"Sr No\") }}</th>\n\t\t\t\t\t\t<th class=\"text-center\" style=\"width: 10%\">{{ _(\"Posting Date\") }}</th>\n\t\t\t\t\t\t<th class=\"text-center\" style=\"width: 15%\">{{ _(\"Invoice No\") }}</th>\n\t\t\t\t\t\t<th class=\"text-center\" style=\"width: 15%\">{{ _(\"Reference\") }}</th>\n\t\t\t\t\t\t<th class=\"text-center\" style=\"width: 8%\">{{ _(\"Chq/Ref No\") }}</th>\n\t\t\t\t\t\t<th class=\"text-center\" style=\"width: 8%\">{{ _(\"Debit\") }}</th>\n\t\t\t\t\t\t<th class=\"text-center\" style=\"width: 8%\">{{ _(\"Credit\") }}</th>\n\t\t\t\t\t\t<th class=\"text-center\" style=\"width: 8%\">{{ _(\"Balance\") }}</th>\n\t\t\t\t\t</tr>\n\t\t\t\t</thead>\n\t\t\t\t<tbody>\n\t\t\t\t\t{% for row in data %}\n\t\t\t\t\t<!--{{row}}-->\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t{% if(row.posting_date) %}\n\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t    {{row.idx-1}}\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t    {{frappe.utils.formatdate(row.posting_date, \"dd MMMM YY\")}}\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t    {{row.voucher_no}}\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t{% if row.voucher_type == \"Payment Entry\" %}\n    \t\t\t\t\t\t\t<td>\n    \t\t\t\t\t\t\t    <p>{{row.against_voucher}}</p>\n    \t\t\t\t\t\t\t    <p>{{row.against_voucher_type}}</p>\n    \t\t\t\t\t\t\t</td>\n    \t\t\t\t\t\t\t<td style=\"text-align: right\">\n    \t\t\t\t\t\t\t    {{frappe.db.get_value(\"Payment Entry\",row.voucher_no,'reference_no')}}\n    \t\t\t\t\t\t\t</td>\n    \t\t\t\t\t\t{% else %}\n    \t\t\t\t\t\t    <td>\n    \t\t\t\t\t\t\t</td>\n    \t\t\t\t\t\t    <td>\n    \t\t\t\t\t\t\t</td>\n    \t\t\t\t\t\t{% endif %}\n\t\t\t\t\t\t\t<td style=\"text-align: right\">\n\t\t\t\t\t\t\t    {{frappe.utils.fmt_money(row.debit, currency=currency)}}\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t<td style=\"text-align: right\">\n\t\t\t\t\t\t\t    {{frappe.utils.fmt_money(row.credit, currency=currency)}}\n\t\t\t\t\t\t\t</td>\n                            <td>\n                                {{ frappe.utils.fmt_money(row.balance, currency=currency) }}\n                            </td>\n\t\t\t\t\t\t{% else %}\n\t\t\t\t\t\t    {% if \"Closing\" in row.account %}\n    \t\t\t\t\t\t{% else %}\n    \t\t\t\t\t\t    {% if \"Opening\" in row.account %}\n        \t\t\t\t\t\t    <td></td>\n        \t\t\t\t\t\t\t<td></td>\n        \t\t\t\t\t\t\t<td></td>\n    \t\t\t\t\t\t\t    <td></td>\n    \t\t\t\t\t\t\t    <td style=\"text-align: right\"><b>{{ row.account | replace(\"'\",\"\") }}</b></td>\n        \t\t\t\t\t\t    <td style=\"text-align: right\">\n    \t\t\t\t\t\t\t\t    {{ frappe.utils.fmt_money(row.debit, currency=currency) }}\n    \t\t\t\t\t\t\t    </td>\n        \t\t\t\t\t\t    <td style=\"text-align: right\">\n        \t\t\t\t\t\t        {{ frappe.utils.fmt_money(row.credit, currency=currency) }}\n        \t\t\t\t\t\t    </td>\n        \t\t\t\t\t\t    <td>{{frappe.utils.fmt_money(row.balance, currency=currency)}}</td>\n        \t\t\t\t\t\t  {% endif %}\n    \t\t\t\t\t\t{% endif %}\n\t\t\t\t\t\t{% endif %}\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t{% endfor %}\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t    <td style=\"text-align: right\"></td>\n\t\t\t\t\t\t    <td style=\"text-align: right\"></td>\n\t\t\t\t\t\t    <td style=\"text-align: right\"></td>\n\t\t\t\t\t\t    <td style=\"text-align: right\"></td>\n\t\t\t\t\t\t    <td style=\"text-align: right\"><b>Total</b></td>\n\t\t\t\t\t\t    <td style=\"text-align: right\">{{frappe.utils.fmt_money(data[-1].debit, currency=currency)}}</td>\n\t\t\t\t\t\t    <td style=\"text-align: right\">{{frappe.utils.fmt_money(data[-1].credit, currency=currency)}}</td>\n\t\t\t\t\t\t    <td></td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t    <td style=\"text-align: right\"></td>\n\t\t\t\t\t\t    <td style=\"text-align: right\"></td>\n\t\t\t\t\t\t    <td style=\"text-align: right\"></td>\n\t\t\t\t\t\t    <td style=\"text-align: right\"></td>\n\t\t\t\t\t\t    <td style=\"text-align: right\"><b>Balance Due</b></td>\n\t\t\t\t\t\t    <td style=\"text-align: right\">{{frappe.utils.fmt_money(data[-1].balance, currency=currency)}}</td>\n\t\t\t\t\t\t    <td></td>\n\t\t\t\t\t\t    <td></td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t</tbody>\n\t\t</table>\n\t\t<br>\n\t\t{% if data_ageing %}\n\t\t\t<table class=\"table table-bordered\" style='border: 0px solid black; width:48%;'>\n\t\t\t\t<thead>\n\t\t\t\t    <tr>\n\t\t\t\t        <th colspan=4 class=\"text-center\" style=\"width: 20%\">Agening Details</th>\n\t\t\t\t    </tr>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td width=12%  style=\"text-align: right\">30</td>\n\t\t\t\t\t\t<td width=12%  style=\"text-align: right\">60</td>\n\t\t\t\t\t\t<td width=12%  style=\"text-align: right\">90</td>\n\t\t\t\t\t\t<!--<td  style=\"text-align: right\">{{ labels_ageing.range4 }}</td>-->\n\t\t\t\t\t\t<td width=12%  style=\"text-align: right\">120 Above</td>\n\t\t\t\t\t</tr>\n\t\t\t\t</thead>\n\t\t\t\t<tbody>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td style=\"text-align: right\"> {{ frappe.utils.fmt_money(data_ageing[0].range1, currency=currency) }} </td>\n\t\t\t\t\t\t<td style=\"text-align: right\"> {{ frappe.utils.fmt_money(data_ageing[0].range2, currency=currency) }} </td>\n\t\t\t\t\t\t<td style=\"text-align: right\"> {{ frappe.utils.fmt_money(data_ageing[0].range3, currency=currency) }} </td>\n\t\t\t\t\t\t<td style=\"text-align: right\"> {{ frappe.utils.fmt_money(data_ageing[0].range5, currency=currency) }} </td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody>\n\t\t\t</table>\n\t\t{% else %}\n\t\t    <table class=\"table table-bordered\" style='border: 0px solid black; width:48%;'>\n\t\t\t\t<thead>\n\t\t\t\t    <tr>\n\t\t\t\t        <th colspan=4 class=\"text-center\" style=\"width: 20%\">Agening Details</th>\n\t\t\t\t    </tr>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td width=12%  style=\"text-align: right\">30</td>\n\t\t\t\t\t\t<td width=12%  style=\"text-align: right\">60</td>\n\t\t\t\t\t\t<td width=12%  style=\"text-align: right\">90</td>\n\t\t\t\t\t\t<td width=12%  style=\"text-align: right\">120 Above</td>\n\t\t\t\t\t</tr>\n\t\t\t\t</thead>\n\t\t\t\t<tbody>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td style=\"text-align: right\"> {{ frappe.utils.fmt_money('0.00', currency=currency) }} </td>\n\t\t\t\t\t\t<td style=\"text-align: right\"> {{ frappe.utils.fmt_money('0.00', currency=currency) }} </td>\n\t\t\t\t\t\t<td style=\"text-align: right\"> {{ frappe.utils.fmt_money('0.00', currency=currency) }} </td>\n\t\t\t\t\t\t<td style=\"text-align: right\"> {{ frappe.utils.fmt_money('0.00', currency=currency) }} </td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody>\n\t\t\t</table>\n\t\t\n\t\t{% endif %}\n\t\t<br>\n        <footer>\n\t\t    <div id=\"content\">\n                <div  id=\"pageFooter\">\n                </div>\n            </div>\n\t\t</footer>\n\t\t</div>\n</div>\n</body>\n\n\n",
 "idx": 0,
 "line_breaks": 0,
 "margin_bottom": 15.0,
 "margin_left": 15.0,
 "margin_right": 15.0,
 "margin_top": 15.0,
 "modified": "2023-03-27 15:11:50.173805",
 "modified_by": "Administrator",
 "module": "Customer Statement",
 "name": "Customer Statement",
 "owner": "Administrator",
 "page_number": "Hide",
 "print_format_builder": 0,
 "print_format_builder_beta": 0,
 "print_format_type": "Jinja",
 "raw_printing": 0,
 "show_section_headings": 0,
 "standard": "Yes"
}